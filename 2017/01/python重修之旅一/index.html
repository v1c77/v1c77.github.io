<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.121.1 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="vici">
<meta name="keywords" content=", vici, blog, heyuhua.com, 何育华, v1c77">
<meta name="description" content="还有6个月就毕业了，才知道原来面试之前原来需要刷题什么的。怪不得之前面试我的人都是一脸看智障的样子&hellip;
本宝宝的第一个专题。第三次系统学习python。2017年计划之一。

年底就是爽，每天就是开开会，下午就自己疯狂coding。
">


<meta property="og:description" content="还有6个月就毕业了，才知道原来面试之前原来需要刷题什么的。怪不得之前面试我的人都是一脸看智障的样子&hellip;
本宝宝的第一个专题。第三次系统学习python。2017年计划之一。

年底就是爽，每天就是开开会，下午就自己疯狂coding。
">
<meta property="og:type" content="article">
<meta property="og:title" content="python重修之旅（一）">
<meta name="twitter:title" content="python重修之旅（一）">
<meta property="og:url" content="http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
<meta property="twitter:url" content="http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
<meta property="og:site_name" content="何育华的日记">
<meta property="og:description" content="还有6个月就毕业了，才知道原来面试之前原来需要刷题什么的。怪不得之前面试我的人都是一脸看智障的样子&hellip;
本宝宝的第一个专题。第三次系统学习python。2017年计划之一。

年底就是爽，每天就是开开会，下午就自己疯狂coding。
">
<meta name="twitter:description" content="还有6个月就毕业了，才知道原来面试之前原来需要刷题什么的。怪不得之前面试我的人都是一脸看智障的样子&hellip;
本宝宝的第一个专题。第三次系统学习python。2017年计划之一。

年底就是爽，每天就是开开会，下午就自己疯狂coding。
">
<meta property="og:locale" content="zh-cn">

  
    <meta property="article:published_time" content="2017-01-17T15:17:27">
  
  
    <meta property="article:modified_time" content="2017-01-17T15:17:27">
  
  
  
  
    
      <meta property="article:tag" content="python">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@bookerHe">


  <meta name="twitter:creator" content="@bookerHe">










  <meta property="og:image" content="https://www.gravatar.com/avatar/85d1ea47d48692ca0ade206fa656bd14?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/85d1ea47d48692ca0ade206fa656bd14?s=640">


    <title>python重修之旅（一）</title>

    <link rel="icon" href="//qiniu.heyuhua.com/blog_favicon.ico">
    

    

    <link rel="canonical" href="http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="http://blog.heyuhua.com/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    

    
      
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-88015219-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="http://blog.heyuhua.com/">何育华的日记</a>
  </div>
  
    
      <a class="header-right-icon st-search-show-outputs"
         href="http://blog.heyuhua.com/#search">
    
    
      <i class="fa fa-lg fa-search"></i>
    
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="http://blog.heyuhua.com/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/85d1ea47d48692ca0ade206fa656bd14?s=110" alt="作者的图片" />
        </a>
        <h4 class="sidebar-profile-name">vici</h4>
        
          <h5 class="sidebar-profile-bio">极度选择困难. <strong>懒癌晚期</strong></h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://blog.heyuhua.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">首页</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://blog.heyuhua.com/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">分类</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://blog.heyuhua.com/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">标签</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://blog.heyuhua.com/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">归档</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://blog.heyuhua.com/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">关于</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/v1c77" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stackoverflow.com/users/6382035/vi-ci" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://blog.heyuhua.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="5"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      python重修之旅（一）
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2017-01-17T15:17:27Z">
        
  一月 17, 2017

      </time>
    
    
  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>还有6个月就毕业了，才知道原来面试之前原来需要刷题什么的。怪不得之前面试我的人都是一脸看智障的样子&hellip;
本宝宝的第一个专题。第三次系统学习python。2017年计划之一。</p>
<blockquote>
<p>年底就是爽，每天就是开开会，下午就自己疯狂coding。</p>
</blockquote>
<h2 id="一道面试题">一道面试题</h2>
<h3 id="-问题平面上有若干个点点与点可以重合寻找一条直线使其能穿过最多的点好吧我承认这是我去面试时候的面试题">&gt; 问题：平面上有若干个点。点与点可以重合，寻找一条直线，使其能穿过最多的点。(好吧我承认这是我去面试时候的面试题。)</h3>
<p>搬运答案。。。<a href="http://www.jiuzhang.com/solutions/max-points-on-a-line/#">这里</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">/**</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">*</span> 本代码由九章算法编辑提供<span style="color:#960050;background-color:#1e0010">。</span>版权所有<span style="color:#960050;background-color:#1e0010">，</span>转发请注明出处<span style="color:#960050;background-color:#1e0010">。</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">*</span> <span style="color:#f92672">-</span> 九章算法致力于帮助更多中国人找到好的工作<span style="color:#960050;background-color:#1e0010">，</span>教师团队均来自硅谷和国内的一线大公司在职工程师<span style="color:#960050;background-color:#1e0010">。</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">*</span> <span style="color:#f92672">-</span> 现有的面试培训课程包括<span style="color:#960050;background-color:#1e0010">：</span>九章算法班<span style="color:#960050;background-color:#1e0010">，</span>系统设计班<span style="color:#960050;background-color:#1e0010">，</span>算法强化班<span style="color:#960050;background-color:#1e0010">，</span>Java入门与基础算法班<span style="color:#960050;background-color:#1e0010">，</span>Android 项目实战班<span style="color:#960050;background-color:#1e0010">，</span>Big Data 项目实战班<span style="color:#960050;background-color:#1e0010">，</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">*</span> <span style="color:#f92672">-</span> 更多详情请见官方网站<span style="color:#960050;background-color:#1e0010">：</span>http:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>jiuzhang<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>source<span style="color:#f92672">=</span>code
</span></span><span style="display:flex;"><span> <span style="color:#f92672">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Definition for a point.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># class Point:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     def __init__(self, a=0, b=0):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         self.x = a</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         self.y = b</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># @param {int[]} points an array of point</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># @return {int} an integer</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">maxPoints</span>(self, points):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Write your code here</span>
</span></span><span style="display:flex;"><span>        len_points <span style="color:#f92672">=</span> len(points)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len_points <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> len_points
</span></span><span style="display:flex;"><span>        max_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> index1 <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len_points):
</span></span><span style="display:flex;"><span>            p1 <span style="color:#f92672">=</span> points[index1]
</span></span><span style="display:flex;"><span>            gradients <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>            infinite_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            duplicate_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> index2 <span style="color:#f92672">in</span> range(index1, len_points):
</span></span><span style="display:flex;"><span>                p2 <span style="color:#f92672">=</span> points[index2]
</span></span><span style="display:flex;"><span>                dx <span style="color:#f92672">=</span> p2<span style="color:#f92672">.</span>x <span style="color:#f92672">-</span> p1<span style="color:#f92672">.</span>x
</span></span><span style="display:flex;"><span>                dy <span style="color:#f92672">=</span> p2<span style="color:#f92672">.</span>y <span style="color:#f92672">-</span> p1<span style="color:#f92672">.</span>y
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">==</span> dx <span style="color:#f92672">and</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">==</span> dy:
</span></span><span style="display:flex;"><span>                    duplicate_count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">==</span> dx:
</span></span><span style="display:flex;"><span>                    infinite_count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                    g <span style="color:#f92672">=</span> float(dy) <span style="color:#f92672">/</span> dx
</span></span><span style="display:flex;"><span>                    gradients[g] <span style="color:#f92672">=</span> (gradients[g] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> gradients<span style="color:#f92672">.</span>has_key(g) <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> infinite_count <span style="color:#f92672">&gt;</span> max_count:
</span></span><span style="display:flex;"><span>                max_count <span style="color:#f92672">=</span> infinite_count
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> k, v <span style="color:#f92672">in</span> gradients<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>                v <span style="color:#f92672">+=</span> duplicate_count
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> v <span style="color:#f92672">&gt;</span> max_count:
</span></span><span style="display:flex;"><span>                    max_count <span style="color:#f92672">=</span> v
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> max_count
</span></span></code></pre></div><h2 id="图的python实现">图的python实现</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> fractions <span style="color:#f92672">import</span> Fraction
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Vertex</span>(object):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 原生点 对象</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, x, y):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> x
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;(</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)&#34;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>x, self<span style="color:#f92672">.</span>y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __str__ <span style="color:#f92672">=</span> __repr__
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Edge</span>(tuple):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 继承自建tuple类型并重写new方法</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __new__(cls, e1, e2):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> tuple<span style="color:#f92672">.</span>__new__(cls, (e1, e2))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Edge(</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#34;</span> <span style="color:#f92672">%</span> (repr(self[<span style="color:#ae81ff">0</span>]), repr(self[<span style="color:#ae81ff">1</span>]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Graph</span>(dict):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, vs<span style="color:#f92672">=</span>[], es<span style="color:#f92672">=</span>[]):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 建立一个新的图，(vs)为顶点vertices列表，(es)为边缘edges列表 &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> vs:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>add_vertex(v)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> es:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>add_edge(e)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_vertex</span>(self, v):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 添加顶点 v:  使用字典结构&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        self[v] <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_edge</span>(self, e):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 添加边缘 e: e 为一个元组(v,w)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            在两个顶点 w 和 v 之间添加成员e ，如果两个顶点之间已有边缘，则替换之 &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        v, w <span style="color:#f92672">=</span> e
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 由于一条边会产生两个项目，因此该实现代表了一个无向图</span>
</span></span><span style="display:flex;"><span>        self[v][w] <span style="color:#f92672">=</span> e
</span></span><span style="display:flex;"><span>        self[w][v] <span style="color:#f92672">=</span> e
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_edge</span>(self, v1, v2):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 接收两个顶点，则返回这条边，否则返回None &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> self[v1][v2]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">vertices</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 返回图中所有顶点的列表 &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>keys()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">edges</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 返回图中边的列表 &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        es <span style="color:#f92672">=</span> set()  <span style="color:#75715e"># 为了避免返回重复的边，设为集合</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v1 <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>vertices():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> v2 <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>vertices():
</span></span><span style="display:flex;"><span>                es<span style="color:#f92672">.</span>add(self<span style="color:#f92672">.</span>get_edge(v2, v1))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        es<span style="color:#f92672">.</span>discard(<span style="color:#66d9ef">None</span>)  <span style="color:#75715e"># 若集合中存在None元素,则删除 无向图可以不用写这步</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> list(es)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_all_edges</span>(self, vs<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 从一个无边的图开始，通过在各个顶点间添加边来生成一个完全图
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            输入为目标顶点的列表，如果为None,则对所有的点进行全联结 &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> vs <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            vs <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>vertices()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v1 <span style="color:#f92672">in</span> vs:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> v2 <span style="color:#f92672">in</span> vs:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> v1 <span style="color:#f92672">is</span> v2:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">continue</span>  <span style="color:#75715e"># 假设不存在单顶点连通</span>
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>add_edge(Edge(v1, v2))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bfs</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        广度优先搜索
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># parents 记录所有可达节点与对应的父节点，这里是一个字典，我们将其 可达节点 作为 key，而将其 父节点 作为 value</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># query_queue 是用来存放待探索节点的 to-do 列表，这里是一个 FIFO</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        node <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>vertices()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        parents, query_queue <span style="color:#f92672">=</span> {node: <span style="color:#66d9ef">None</span>}, deque([node])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> query_queue:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># 总是从 FIFO 的左侧弹出待探索的节点</span>
</span></span><span style="display:flex;"><span>            q_node <span style="color:#f92672">=</span> query_queue<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> neighbor <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>out_vertices(q_node):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> neighbor <span style="color:#f92672">in</span> parents:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># 记录探索到的邻居节点及其父节点</span>
</span></span><span style="display:flex;"><span>                parents[neighbor] <span style="color:#f92672">=</span> q_node
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># 将其邻居节点推入 to-do 列表</span>
</span></span><span style="display:flex;"><span>                query_queue<span style="color:#f92672">.</span>append(neighbor)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#如果想只得到点的话 可以</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># return prints.key()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> parents
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">out_vertices</span>(self, v):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 接受一个Vertex并返回邻近顶点（通过一条边连接到给定节点的节点）的列表 &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self[v]<span style="color:#f92672">.</span>keys()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">out_edges</span>(self, v):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34; 接受一个Vertex并返回连接到给定节点的边的列表 &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self[v]<span style="color:#f92672">.</span>values()
</span></span></code></pre></div><h2 id="socket">socket</h2>
<h2 id="threadprocess">thread／process</h2>
<blockquote>
<p>文字部分详见小明明 线程篇 和进程篇</p>
</blockquote>
<h3 id="threading">threading</h3>
<blockquote>
<p>当前代码版本&mdash;&ndash;》<a href="https://github.com/woailuoli993/test/blob/660297df0614925307bb3272dde6eace19284cf0/dosth/testthread.py">这里</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Created by vici on 22/01/2017</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> threading
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> platform
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> logging
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Queue <span style="color:#f92672">import</span> Queue
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> randint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>__doc__ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34; 抄董伟明,官方文档，廖雪峰 bogo  。。。。 threading 实验结果记录
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>basicConfig(level<span style="color:#f92672">=</span>logging<span style="color:#f92672">.</span>DEBUG,
</span></span><span style="display:flex;"><span>                    format<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;(</span><span style="color:#e6db74">%(threadName)-9s</span><span style="color:#e6db74">) |||| </span><span style="color:#e6db74">%(message)s</span><span style="color:#e6db74">&#39;</span>,)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">timeit</span>(func):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;一个简单的函数时间装饰器&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>        start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>        func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>        end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> COST: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(func<span style="color:#f92672">.</span>__name__, end<span style="color:#f92672">-</span>start))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> wrapper
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show_thread_itself</span>(arg):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;threading </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> is running! &#34;</span><span style="color:#f92672">.</span>format(threading<span style="color:#f92672">.</span>current_thread()<span style="color:#f92672">.</span>getName()))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Thread </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> &gt;&gt;&gt; </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(threading<span style="color:#f92672">.</span>current_thread()<span style="color:#f92672">.</span>getName(), i))
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Thread </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> end&#34;</span><span style="color:#f92672">.</span>format(threading<span style="color:#f92672">.</span>current_thread()<span style="color:#f92672">.</span>getName()))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fib</span>(n):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> n <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> fib(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> fib(n<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@timeit</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">nothread</span>():
</span></span><span style="display:flex;"><span>    fib(<span style="color:#ae81ff">34</span>)
</span></span><span style="display:flex;"><span>    fib(<span style="color:#ae81ff">34</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@timeit</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">withthread</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>fib, args<span style="color:#f92672">=</span>(<span style="color:#ae81ff">34</span>,))
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    main_thread <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>current_thread()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> threading<span style="color:#f92672">.</span>enumerate():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> t <span style="color:#f92672">is</span> main_thread:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>balance <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>lock <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Lock()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">change_balance</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> balance
</span></span><span style="display:flex;"><span>    balance <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>    balance <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">money_laundering</span>(num):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> xrange(num):
</span></span><span style="display:flex;"><span>        change_balance()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">money_laundering_priveate</span>(num):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> xrange(num):
</span></span><span style="display:flex;"><span>        lock<span style="color:#f92672">.</span>acquire()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            change_balance()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>            lock<span style="color:#f92672">.</span>release()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lock_is_important</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    这里的lock是一种互斥的 可重获的 锁 在一个加锁thread进行完之后将会释放。
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    lock 相当于信号量（Sempahore） 为 1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@timeit</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test1</span>():
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Before i go to bank ,I have </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(balance))
</span></span><span style="display:flex;"><span>        t1 <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>money_laundering, args<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2000000</span>,))
</span></span><span style="display:flex;"><span>        t2 <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>money_laundering, args<span style="color:#f92672">=</span>(<span style="color:#ae81ff">4000000</span>,))
</span></span><span style="display:flex;"><span>        t1<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>        t2<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>        t1<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>        t2<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;after two public_money_laundering, I have </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(balance))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@timeit</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test2</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">global</span> balance
</span></span><span style="display:flex;"><span>        balance <span style="color:#f92672">=</span> <span style="color:#ae81ff">2000</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Before i go to a new bank ,I have </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(balance))
</span></span><span style="display:flex;"><span>        t3 <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>money_laundering_priveate, args<span style="color:#f92672">=</span>(<span style="color:#ae81ff">3000000</span>,))
</span></span><span style="display:flex;"><span>        t4 <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>money_laundering_priveate, args<span style="color:#f92672">=</span>(<span style="color:#ae81ff">3000000</span>,))
</span></span><span style="display:flex;"><span>        t3<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>        t4<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>        t3<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>        t4<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;after two private money_launderingm I have </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(balance))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    test1()
</span></span><span style="display:flex;"><span>    test2()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumer_producer</span>():
</span></span><span style="display:flex;"><span>    condition <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Condition()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumer</span>(cond):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>current_thread()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> start , and waiting for proc&#39;</span><span style="color:#f92672">.</span>format(t<span style="color:#f92672">.</span>name))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> cond:
</span></span><span style="display:flex;"><span>            cond<span style="color:#f92672">.</span>wait()
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> making resource avaiable to consumer&#39;</span><span style="color:#f92672">.</span>format(t<span style="color:#f92672">.</span>name))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">producer</span>(cond):
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>current_thread()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> cond:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> producer acaiable !&#39;</span><span style="color:#f92672">.</span>format(t<span style="color:#f92672">.</span>name))
</span></span><span style="display:flex;"><span>            cond<span style="color:#f92672">.</span>notifyAll() <span style="color:#75715e"># 激活条件</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    c1 <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;cons1&#39;</span>, target<span style="color:#f92672">=</span>consumer, args<span style="color:#f92672">=</span>(condition,))
</span></span><span style="display:flex;"><span>    c2 <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;cons2&#39;</span>, target<span style="color:#f92672">=</span>consumer, args<span style="color:#f92672">=</span>(condition,))
</span></span><span style="display:flex;"><span>    p <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;prod&#39;</span>, target<span style="color:#f92672">=</span>producer, args<span style="color:#f92672">=</span>(condition,))
</span></span><span style="display:flex;"><span>    c1<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    c2<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumber_producer_event</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;一个线程发送事件，其他的线程等待事件的触发  生产者消费者模型&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> randint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    TIMEOUT <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    eve <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Event()
</span></span><span style="display:flex;"><span>    ll <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    threads <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumer</span>(event, l):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;消费者&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        mt <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>currentThread()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            event_is_set <span style="color:#f92672">=</span> event<span style="color:#f92672">.</span>wait(TIMEOUT)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> event_is_set:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                    integer <span style="color:#f92672">=</span> l<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> pop from list by </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(integer, mt<span style="color:#f92672">.</span>name))
</span></span><span style="display:flex;"><span>                    event<span style="color:#f92672">.</span>clear()  <span style="color:#75715e"># 重制事件状态</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">IndexError</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">pass</span>  <span style="color:#75715e"># 刚启动时容错。</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">producer</span>(event, l):
</span></span><span style="display:flex;"><span>        mt <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>currentThread()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            integer <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>            l<span style="color:#f92672">.</span>append(integer)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> is append to list by </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(integer, mt<span style="color:#f92672">.</span>name))
</span></span><span style="display:flex;"><span>            event<span style="color:#f92672">.</span>set()
</span></span><span style="display:flex;"><span>            time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> name <span style="color:#f92672">in</span> (<span style="color:#e6db74">&#39;consumer1&#39;</span>, <span style="color:#e6db74">&#39;consumer2&#39;</span>):
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(name<span style="color:#f92672">=</span>name, target<span style="color:#f92672">=</span>consumer, args<span style="color:#f92672">=</span>(eve, ll))
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>        threads<span style="color:#f92672">.</span>append(t)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    p <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;producer&#39;</span>, target<span style="color:#f92672">=</span>producer, args<span style="color:#f92672">=</span>(eve, ll))
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>    threads<span style="color:#f92672">.</span>append(p)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> threads:
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumer_producer_queue</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 有两种模式 priority 优先级模式 LIFOqueue后进先出模式。&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># priority 模式</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> Queue <span style="color:#f92672">import</span> PriorityQueue, LifoQueue
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> PriorityQueue()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">double</span>(num):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> num <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">producer</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            wt <span style="color:#f92672">=</span> random()
</span></span><span style="display:flex;"><span>            time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;put&#39;</span>, wt)
</span></span><span style="display:flex;"><span>            q<span style="color:#f92672">.</span>put((double, wt))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumer</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            task, arg <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>            print arg, task(arg)
</span></span><span style="display:flex;"><span>            q<span style="color:#f92672">.</span>task_done()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> target <span style="color:#f92672">in</span> (producer, consumer):
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>target)
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumer_producer_priqueue</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;priority 优先级队列&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> randint
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> Queue <span style="color:#f92672">import</span> PriorityQueue
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pri_q <span style="color:#f92672">=</span> PriorityQueue()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">triple</span>(n):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> n <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">consumer</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> pri_q<span style="color:#f92672">.</span>empty():
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>            pri, target, arg <span style="color:#f92672">=</span> pri_q<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;[PRI: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> * 3 = </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(pri, arg, target(arg)))
</span></span><span style="display:flex;"><span>            pri_q<span style="color:#f92672">.</span>task_done()
</span></span><span style="display:flex;"><span>            time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">producer</span>():
</span></span><span style="display:flex;"><span>        count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> count <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">50</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>            pri <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;put priority </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> &#39;</span><span style="color:#f92672">.</span>format(pri))
</span></span><span style="display:flex;"><span>            pri_q<span style="color:#f92672">.</span>put((pri, triple, pri))
</span></span><span style="display:flex;"><span>            count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> targ <span style="color:#f92672">in</span> (producer, consumer):
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>targ)
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">daemon_and_not_daemon</span>():
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">nd</span>():
</span></span><span style="display:flex;"><span>        logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;start!&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>        logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;end!&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">d</span>():
</span></span><span style="display:flex;"><span>        logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;start&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;end&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>d, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;deamon&#34;</span>)
</span></span><span style="display:flex;"><span>    nt <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>nd, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;no-deamon&#39;</span>)
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>setDaemon(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    nt<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 论join 的重要性。</span>
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># threading pool &amp;&amp; threading module programing</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quadra</span>(strings):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> str(strings) <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Worker</span>(threading<span style="color:#f92672">.</span>Thread):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, queue):
</span></span><span style="display:flex;"><span>        super(Worker, self)<span style="color:#f92672">.</span>__init__()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_q <span style="color:#f92672">=</span> queue
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>daemon <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            f, args, kwargs <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_q<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#39;USE </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> &#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>name))
</span></span><span style="display:flex;"><span>                print(f(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>                print e
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_q<span style="color:#f92672">.</span>task_done()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThreadingPool</span>(object):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, num_con<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_q <span style="color:#f92672">=</span> Queue(num_con)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> xrange(num_con):
</span></span><span style="display:flex;"><span>            Worker(self<span style="color:#f92672">.</span>_q)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_task</span>(self, f, <span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_q<span style="color:#f92672">.</span>put((f, args, kwargs))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wait_complete</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_q<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_threading_pool</span>():
</span></span><span style="display:flex;"><span>    pool <span style="color:#f92672">=</span> ThreadingPool(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">1000</span>):
</span></span><span style="display:flex;"><span>        wt <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>)
</span></span><span style="display:flex;"><span>        pool<span style="color:#f92672">.</span>add_task(quadra, wt)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    pool<span style="color:#f92672">.</span>wait_complete()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># nothread()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># withthread(）</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ----------------- no threading vs use treading-------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># show_thread_itself(&#39;no muti&#39;)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print(&#39;threading is running! thraead name is {}&#39;.format(threading.current_thread().getName()))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># t = threading.Thread(target=show_thread_itself, args=(123,), name=&#39;Do yourself&#39;)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># t.start()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># t.join()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print(&#39;threading {} end.&#39;.format(threading.current_thread().getName()))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ------------------ problem on thread lock ---------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># lock_is_important()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ------------------ cunsumer / producter model with condition -----------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># consumer_producer()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ------------------ cumsumer/ producter model with event -----------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># consumber_producer_event()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># --------   deamon and not deamon threading   ------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># daemon_and_not_daemon()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ------------------ cunsumer / producter model with Queue -----------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># consumer_producer_queue() # 普通队列</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># consumer_producer_priqueue()  # 优先级队列</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ------------------ threadingpool ------------</span>
</span></span><span style="display:flex;"><span>    test_threading_pool()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;python version is </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(platform<span style="color:#f92672">.</span>python_version()))
</span></span><span style="display:flex;"><span>    main()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;done!&#34;</span>)
</span></span></code></pre></div><h3 id="multiprocessing-进程部分">multiprocessing 进程部分</h3>
<h4 id="mapreduce-with-multiprocess">mapreduce with multiprocess</h4>
<blockquote>
<p><a href="https://pymotw.com/2/multiprocessing/mapreduce.html">文章搬运</a>, <a href="https://github.com/woailuoli993/test/blob/master/dosth/testmapreducemultiprocess.py">代码拷贝</a></p>
</blockquote>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">标签</span><br/>
                    
  <a class="tag tag--primary tag--small" href="http://blog.heyuhua.com/tags/python/">python</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://blog.heyuhua.com/2017/01/aria2-%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" data-tooltip="aria2 配置笔记">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://blog.heyuhua.com/2017/01/2017-2018%E5%B9%B4-%E4%B8%A4%E5%B9%B4%E8%AE%A1%E5%88%92/" data-tooltip="2017-2018年 两年计划">
              
                  <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2024 <a href="https://github.com/v1c77">v1c77</a><br><a href="http://beian.miit.gov.cn">粤ICP备19031392号</a>. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://blog.heyuhua.com/2017/01/aria2-%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" data-tooltip="aria2 配置笔记">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://blog.heyuhua.com/2017/01/2017-2018%E5%B9%B4-%E4%B8%A4%E5%B9%B4%E8%AE%A1%E5%88%92/" data-tooltip="2017-2018年 两年计划">
              
                  <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://blog.heyuhua.com/2017/01/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fblog.heyuhua.com%2F2017%2F01%2Fpython%25E9%2587%258D%25E4%25BF%25AE%25E4%25B9%258B%25E6%2597%2585%25E4%25B8%2580%2F">
          <i class="fa fa-facebook-official"></i><span>分享到 Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http%3A%2F%2Fblog.heyuhua.com%2F2017%2F01%2Fpython%25E9%2587%258D%25E4%25BF%25AE%25E4%25B9%258B%25E6%2597%2585%25E4%25B8%2580%2F">
          <i class="fa fa-twitter"></i><span>分享到 Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http%3A%2F%2Fblog.heyuhua.com%2F2017%2F01%2Fpython%25E9%2587%258D%25E4%25BF%25AE%25E4%25B9%258B%25E6%2597%2585%25E4%25B8%2580%2F">
          <i class="fa fa-google-plus"></i><span>分享到 Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/85d1ea47d48692ca0ade206fa656bd14?s=110" alt="作者的图片" />
    
    <h4 id="about-card-name">vici</h4>
    
      <div id="about-card-bio">极度选择困难. <strong>懒癌晚期</strong></div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        software engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Shenzhen | Beijing | Shanghai
      </div>
    
  </div>
</div>

    

    
  
    <div id="cover" style="background-image:url('http://qiniu.heyuhua.com/India1.little.jpg!huge.webp');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="http://blog.heyuhua.com/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


  
    <script src="http://qiniu.heyuhua.com/highlight.pack.js"></script>
  

<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'http:\/\/blog.heyuhua.com\/2017\/01\/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80\/';
          
            this.page.identifier = '\/2017\/01\/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%B8%80\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'vic1blog';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

