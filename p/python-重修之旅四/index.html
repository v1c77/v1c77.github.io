<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=" æˆ‘æœ‰ä¸€ä¸‡ä¸ªç†ç”±ä¸ç”¨vim&amp;amp;emacs
"><title>python é‡ä¿®ä¹‹æ—…ï¼ˆå››ï¼‰</title>
<link rel=canonical href=http://blog.heyuhua.com/p/python-%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E5%9B%9B/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="python é‡ä¿®ä¹‹æ—…ï¼ˆå››ï¼‰"><meta property="og:description" content=" æˆ‘æœ‰ä¸€ä¸‡ä¸ªç†ç”±ä¸ç”¨vim&amp;amp;emacs
"><meta property="og:url" content="http://blog.heyuhua.com/p/python-%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E5%9B%9B/"><meta property="og:site_name" content="æˆ‘çš„æ—¥è®°"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="python"><meta property="article:published_time" content="2017-07-21T16:28:18+00:00"><meta property="article:modified_time" content="2017-07-21T16:28:18+00:00"><meta name=twitter:title content="python é‡ä¿®ä¹‹æ—…ï¼ˆå››ï¼‰"><meta name=twitter:description content=" æˆ‘æœ‰ä¸€ä¸‡ä¸ªç†ç”±ä¸ç”¨vim&amp;amp;emacs
"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/mxbc_love_hu84bcc3680e7c4ed0b569d38fde18a01e_187938_300x0_resize_box_1.gif width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ«¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>æˆ‘çš„æ—¥è®°</a></h1><h2 class=site-description>drafts.....</h2></div></header><ol class=social-menu><li><a href=https://github.com/v1c77 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://stackoverflow.com/users/6382035/vi-ci target=_blank title="Stack Overflow" rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-stackoverflow" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v1a2 2 0 002 2h12a2 2 0 002-2v-1"/><path d="M8 16h8"/><path d="M8.322 12.582l7.956.836"/><path d="M8.787 9.168l7.826 1.664"/><path d="M10.096 5.764l7.608 2.472"/></svg></a></li><li><a href=https://t.me/v1c77 target=_blank title=telegram rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-telegram" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4 6 6 4-16-18 7 4 2 2 6 3-4"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>æš—è‰²æ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#ä¸€-weakref----å¼±å¼•ç”¨>ä¸€. weakref â€” å¼±å¼•ç”¨</a></li><li><a href=#äºŒ-unittestmock--è™šå‡å¯¹è±¡>äºŒ. unittest.mock â€” è™šå‡å¯¹è±¡</a></li><li><a href=#ä¸‰-collections-é«˜çº§å®¹å™¨æ•°æ®ç±»å‹>ä¸‰. collections é«˜çº§å®¹å™¨æ•°æ®ç±»å‹</a><ol><li><a href=#1-chainmapé“¾è¡¨æ˜ å°„>1. ChainMapï¼ˆé“¾è¡¨æ˜ å°„ï¼‰</a></li><li><a href=#2-counterè®¡æ•°å™¨>2. Counterï¼ˆè®¡æ•°å™¨ï¼‰</a></li><li><a href=#3-dequeåŒå‘é˜Ÿåˆ—>3. dequeï¼ˆåŒå‘é˜Ÿåˆ—ï¼‰</a></li><li><a href=#4-defaultdict-å­—å…¸å·¥å‚>4. defaultdict ï¼ˆå­—å…¸å·¥å‚ï¼‰</a></li><li><a href=#5-namedtupleå‘½åå…ƒç»„å·¥å‚>5. namedtupleï¼ˆå‘½åå…ƒç»„å·¥å‚ï¼‰</a></li><li><a href=#6-ordereddictæœ‰åºå­—å…¸>6. OrderedDictï¼ˆæœ‰åºå­—å…¸ï¼‰</a></li><li><a href=#7-userdict-userlist-userstring-é›†åˆç±»å‹åŒ…è£…å¯¹è±¡>7. UserDict, UserList, UserString é›†åˆç±»å‹åŒ…è£…å¯¹è±¡</a><ol><li></li></ol></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/develop/>develop</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/python-%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E5%9B%9B/>python é‡ä¿®ä¹‹æ—…ï¼ˆå››ï¼‰</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jul 21, 2017</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é˜…è¯»æ—¶é•¿: 9 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><blockquote><p>æˆ‘æœ‰ä¸€ä¸‡ä¸ªç†ç”±ä¸ç”¨vim&amp;emacs</p></blockquote><h2 id=ä¸€-weakref----å¼±å¼•ç”¨>ä¸€. weakref â€” å¼±å¼•ç”¨</h2><p>weakref æ¨¡å— è®©æˆ‘ä»¬å¯ä»¥åœ¨codingæ—¶ ä¸ºå¯¹è±¡æ·»åŠ å¼±å¼•ç”¨</p><p><em>referent</em>ï¼š ä¸€ä¸ªè¢«å¼±å¼•ç”¨çš„å¯¹è±¡</p><p>ç›¸å¯¹ä¸€ä¸ªhard reference(å¼ºå¼•ç”¨ï¼‰æ¥è¯´ ï¼Œå¯¹è±¡çš„å¼±å¼•ç”¨æ— æ³•è®©å¯¹è±¡ä¿æŒæ´»åŠ¨æ€ï¼šå½“å¯¹è±¡çš„å‰©ä½™å¼•ç”¨å…¨éƒ¨å¼•ç”¨ä¸ºå¼±å¼•ç”¨æ—¶ï¼Œgcå¯ä»¥é”€æ¯è¯¥å¼±å¼•ç”¨å¯¹è±¡å¹¶é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚å¦ä¸€ä¸ªç‰¹æ€§æ˜¯ï¼Œåœ¨è¯¥å¯¹è±¡è¢«å®Œå…¨é”€æ¯å‰ï¼Œä½ ä»ç„¶å¯ä»¥æ”¾è‚†çš„è°ƒç”¨å®ƒã€‚ï¼ˆå½“ç„¶ä½ ä¸ä¼šçŸ¥é“å®ƒè¿”å›çš„åˆ°åº•æ˜¯è¯¥å¯¹è±¡è¿˜æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ã€‚ã€‚ï¼‰</p><p>å¼±å¼•ç”¨çš„ä¸»è¦è¢«ç”¨æ¥è®¾è®¡ æ”¾ç½®å¤§å¯¹è±¡çš„æ˜ å°„è¡¨ï¼ç¼“å­˜ç©ºé—´ã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼š</p><p>â€‹ ğŸŒ°</p><p>Ê• â€¢á´¥â€¢Ê”</p><p>å¦‚æœæœ‰å¾ˆå¤šåºå¤§çš„äºŒè¿›åˆ¶å›¾å½¢å¯¹è±¡ï¼Œè€Œä½ å¸Œæœ›å°†æ¯ä¸ªå›¾åƒä¸ä¸€ä¸ªåå­—åšå…³è”ã€‚å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„dictå­—å…¸æ¥æ˜ å°„name : imageï¼Œ æˆ–è€… image : name, è¿™äº›å›¾å½¢å¯¹è±¡å°†ä¼šä¸€ç›´è¢«ä¿æŒåœ¨å†…å­˜ä¸­ã€‚äºæ˜¯ä¹ <code>WeakKeyDictionary</code> å’Œ <code>WeakValueDictionary</code> ç±»å‹åº”è¿è€Œç”Ÿã€‚ä»–ä»¬åˆ†åˆ«æ”¯æŒ å¯¹äº dict ä¸­ keyå€¼å’Œvalueçš„weakrefã€‚ï¼ˆè®© image åœ¨ä¸€ä¸ªWeakKeyDictionary å­—å…¸ä¸­å……å½“key| è®© image åœ¨ WeakValueDictionaryå­—å…¸ä¸­å……å½“valueï¼‰</p><p>åœ¨ python 3.4 ä¸­ weakref æ·»åŠ äº†ä¸€ä¸ªæ³¨å†Œæ¸…ç†å‡½æ•°çš„å›è°ƒå…¥å£ <code>finalize</code>(def finalize(fund, *arg, **kargs)) . è¿™ä¸ªå›è°ƒä¼šåœ¨å¼±å¼•ç”¨å¯¹è±¡è¢«gcæ—¶è°ƒç”¨ã€‚ ç±»ä¼¼äº__del__ magic æ–¹æ³•ï¼Œè¯¥å›è°ƒçš„å¼‚å¸¸å¯ä»¥åœ¨æ ‡å‡†è¾“å‡ºä¸­æ˜¾ç¤ºï¼Œä½†æ˜¯ä¸èƒ½è¢«ä¼ æ’­ã€‚</p><h2 id=äºŒ-unittestmock--è™šå‡å¯¹è±¡>äºŒ. unittest.mock â€” è™šå‡å¯¹è±¡</h2><p><code>unittest.mock</code> å¤§å¤šè¢«åº”ç”¨åœ¨pythonçš„æµ‹è¯•ä¸­ã€‚ä½ å¯ä»¥å°†ç¨‹åºä¸­çš„æŸäº›éƒ¨åˆ†ç”¨mockå¯¹è±¡è¿›è¡Œæ›¿æ¢ï¼Œå¹¶æ–­è¨€ï¼å®šåˆ¶å…¶è¡¨ç°ã€‚</p><p>Python3.5å†…ç½®äº†mockæ¨¡å—ï¼ˆunites.mock), å…¶å¸¸ç”¨ æ–¹å¼ä¸º æŒ‡å®šè¿”å›å€¼ï¼ˆreaturn_valueï¼‰, æŒ‡å®šhookè¿”å›å‡½æ•° <code>side_effect</code>, å’Œ ä¸Šä¸‹æ–‡æ§åˆ¶æ–¹æ³• <code>mock.patch</code>ã€‚</p><p>åœ¨å·¥ä½œé¡¹ç›®ä¸­ï¼ŒåŒäº‹ä»¬é‡‡ç”¨äº† pytestæ­å»ºé›†æˆæµ‹è¯•ç¯å¢ƒï¼Œå…¶ä¸­çš„<code>monkeypatch</code>å·¥ä½œåŸç†ä¸mockç›¸ä¼¼ã€‚ä½†monkeypatchæ›´å±€é™äºå¯¹æŒ‡å®šæ¨¡å—æˆ–å¯¹è±¡è¿›è¡Œpatchï¼Œmockçš„ä¸°å¯Œæ¥å£è¿˜å¯ä»¥åº”ç”¨åœ¨é¡¹ç›®çš„profileåŠå…¶ä»–æ›´å¤šåº”ç”¨åœºæ™¯ä¸­ã€‚</p><h2 id=ä¸‰-collections-é«˜çº§å®¹å™¨æ•°æ®ç±»å‹>ä¸‰. collections é«˜çº§å®¹å™¨æ•°æ®ç±»å‹</h2><p>python2.7æ—¶æœŸçš„ collections åŒ…æ‹¬ <code>nametuple</code>, <code>deque</code>, <code>ChainMap</code> , <code>Counter</code>,<code>OrderDict</code>,<code>defaultdict</code>, åœ¨ python3ä¸­æ·»åŠ äº†<code>UserDict</code>, <code>UserList</code>,<code> UserString</code>ä¸‰ä¸ªç±»å‹ ã€‚</p><h3 id=1-chainmapé“¾è¡¨æ˜ å°„>1. ChainMapï¼ˆé“¾è¡¨æ˜ å°„ï¼‰</h3><p>ChainMapæ€»ä¼šè®©äººæƒ³åˆ°æ•°æ®ç»“æ„ã€‚ç„¶åæƒ³èµ·å¤§ä¸€å†™cé“¾è¡¨çš„ç¾å¥½æ—¶å…‰ã€‚å½“ç„¶ä¹Ÿä¼šæƒ³èµ·iteratortools çš„ chainã€‚</p><p>ChainMap å¯ä»¥å¿«é€Ÿçš„å¯¹å¤šä¸ªä¼ å…¥çš„dict æˆ–map è¿›è¡Œ é“¾æ¥linkï¼Œè¿”å›ä¸€ä¸ªå¯ä»¥å½“ä½œå•ä¸€å•å…ƒçš„å¯¹è±¡ã€‚</p><p>å½“æ²¡æœ‰æ˜ å°„è¢«ä¼ å…¥æ—¶ï¼ŒChainMapä¼šé»˜è®¤è¿”å›ç©ºdictã€‚</p><p>æ‰€æœ‰ä¼ å…¥çš„æ˜ å°„éƒ½ä¼šè¢«å‚¨å­˜åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ChainMapçš„<code>maps</code> å±æ€§è¿›è¡ŒæŸ¥çœ‹å’Œç¼–è¾‘ã€‚å¦‚æœè¯¥åˆ—è¡¨ä¸­çš„å…ƒç´ è¢«æ›´æ”¹ï¼Œ chainmapç”±äºå¯¹è¯¥å±æ€§çš„ä¾èµ–ï¼Œå…¶å±•ç¤ºå†…å®¹ä¹Ÿä¼šç›¸åº”æ”¹å˜ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Collection</span> <span class=kn>import</span> <span class=n>ChainMap</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=n>ChainMap</span><span class=p>(</span><span class=nb>locals</span><span class=p>(),</span> <span class=nb>globals</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>b</span><span class=o>.</span><span class=n>new_child</span><span class=p>()</span> <span class=o>==</span> <span class=n>ChainMap</span><span class=p>({},</span> <span class=o>*</span><span class=n>b</span><span class=o>.</span><span class=n>maps</span><span class=p>)</span>  <span class=c1># True</span>
</span></span></code></pre></td></tr></table></div></div><p>â€‹</p><h3 id=2-counterè®¡æ•°å™¨>2. Counterï¼ˆè®¡æ•°å™¨ï¼‰</h3><p>æœ‰æ—¶å€™ä½ ä¼šè§‰å¾—æ‰¾å·¥ä½œçš„æ—¶å€™é¢è¯•å®˜é—®çš„é—®é¢˜éƒ½ç‰¹åˆ«ç®€å•ï¼Œæ¯”å¦‚è¯´é—®åˆ°æ–‡ä»¶çš„è¯é¢‘ç»Ÿè®¡ï¼Œå¯èƒ½åªä¼šæƒ³åˆ°ç”¨dictæˆ–è€…collections.defaultdict æ¥ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å­—å…¸ã€‚</p><p>The pythonic way should beï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl><span class=c1># å“ˆå§†è±ç‰¹æˆå‰§çš„è¯é¢‘</span>
</span></span><span class=line><span class=cl><span class=n>words</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\w+&#39;</span><span class=p>,</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;hamlet.txt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>Counter</span><span class=p>(</span><span class=n>words</span><span class=p>)</span><span class=o>.</span><span class=n>most_common</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span> <span class=o>==</span> \
</span></span><span class=line><span class=cl><span class=p>[(</span><span class=s1>&#39;the&#39;</span><span class=p>,</span> <span class=mi>1143</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;and&#39;</span><span class=p>,</span> <span class=mi>966</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;to&#39;</span><span class=p>,</span> <span class=mi>762</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;of&#39;</span><span class=p>,</span> <span class=mi>669</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;i&#39;</span><span class=p>,</span> <span class=mi>631</span><span class=p>),</span>
</span></span><span class=line><span class=cl> <span class=p>(</span><span class=s1>&#39;you&#39;</span><span class=p>,</span> <span class=mi>554</span><span class=p>),</span>  <span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=mi>546</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;my&#39;</span><span class=p>,</span> <span class=mi>514</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;hamlet&#39;</span><span class=p>,</span> <span class=mi>471</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;in&#39;</span><span class=p>,</span> <span class=mi>451</span><span class=p>)]</span>
</span></span></code></pre></td></tr></table></div></div><p>Counterçš„dictæ¥å£è®¾è®¡åœ¨è¯·æ±‚è®¿é—®ä¸å­˜åœ¨keyå¯¹åº”valueæ—¶å¹¶ä¸ä¼šæŠ›å‡ºKeyErrorå¼‚å¸¸ï¼Œè€Œæ˜¯ä¼šè¿”å›<code>0</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>counts</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>([</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>counts</span><span class=p>[</span><span class=s1>&#39;c&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span>  <span class=c1># True</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸‰ä¸ªå®ç”¨æ–¹æ³• python3.1+ã€‚</p><p><code>most_common(n)</code> è¿”å›é¢‘åº¦æœ€é«˜çš„å‰nä¸ªè®¡æ•°å¯¹è±¡ï¼ŒåŠé¢‘æ•°ã€‚</p><p><code>elements()</code>ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¦‚æœå°†è¿­ä»£å™¨è½¬åŒ–æˆlistï¼Œ æ¯ä¸ªcounterè®°å½•çš„å…ƒç´ éƒ½ä¼šåœ¨listä¸­å‡ºç°å…¶å¯¹åº”çš„é¢‘æ•°æ¬¡æ•°ï¼Œè€Œä¸”æ— åºã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>c</code>.elements() å¯èƒ½æ˜¯ abbï¼Œ ä¹Ÿå¯èƒ½æ˜¯ bbaï¼Œ è¿˜å¯èƒ½æ˜¯ babã€‚</p><p><code>subtract()</code> æ–¹æ³•æ¥æ”¶å¯è¿­ä»£å¯¹è±¡æˆ–æ˜ å°„ï¼Œåœ¨åŸæœ‰counterå¯¹è±¡ä¸Šè¿›è¡Œç›¸åº”çš„å‡æ³•æ“ä½œã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>d</span><span class=o>=-</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>d</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>.</span><span class=n>subtract</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># c update to Counter({&#39;a&#39;: 3, &#39;b&#39;: 0, &#39;c&#39;: -3, &#39;d&#39;: -6})</span>
</span></span></code></pre></td></tr></table></div></div><p>Counter å®ç°äº†å¤§éƒ¨åˆ†çš„dictæ¥å£ï¼Œexceptï¼š</p><ul><li><p><code>fromkeys()</code> å¹¶æ²¡æœ‰è¢«å®ç°</p><ul><li><code>update()</code>å¯¹ä¼ å…¥çš„å¯è¿­ä»£å¯¹è±¡è¿›è¡Œè®¡æ•°ï¼Œå°†ç»“æœåŠ å…¥åˆ°åŸå¯¹è±¡ã€‚</li></ul><p>â€‹</p></li></ul><p>åœ¨python3.3+ ä¸­ï¼Œ Counter è¿˜é‡è½½äº†ä½äº¦æˆ–åŠåŠ å‡è¿ç®—ç¬¦å·ã€‚ï¼ˆä¸å¿å¿ƒç»§ç»­æŠ„æ–‡æ¡£äº†ï¼‰è®°ä½ï¼š <code>-</code>è·Ÿ<code>subtract()</code>ä¸ä¸€æ ·ï¼Œ <code>&</code>å–å·¦å³æœ€å°ï¼Œ <code>|</code>å–å·¦å³æœ€å¤§ã€‚ å•ä¸€<code>+</code> ,<code>-</code>å·èµ·è®¡æ•°ç­›é€‰ä½œç”¨ã€‚</p><h3 id=3-dequeåŒå‘é˜Ÿåˆ—>3. dequeï¼ˆåŒå‘é˜Ÿåˆ—ï¼‰</h3><p>è¿™ç©æ„æŠ«ç€dequeçš„ç¾Šçš®å¹²ç€listçš„æ´»ã€‚</p><p>ç”¨æ³•ï¼šdeque([iterable[, maxlen]])</p><p>dequeçš„ç‰¹æ€§æ˜¯å›´ç»•maxlenè¿™ä¸€å‚æ•°çš„ï¼Œæ‰€ä»¥ä¸å®šä¹‰maxlençš„dequeè¿˜ä¸å¦‚listã€‚ã€‚ã€‚å› ä¸ºlistä¸ºå˜é•¿liståšäº†å†…å­˜ä¼˜åŒ–ï¼Œè€Œä¸”listä¸‹æ ‡è®¿é—®æ›´å¿«ã€‚</p><p>è®¨è®ºä¸€ä¸‹åœ¨maxlenå®šä¹‰äº†ä¹‹åçš„æƒ…å†µã€‚å½“dequeæ»¡ï¼Œå‘ä»»æ„ä¸€ç«¯æ·»åŠ æ•°æ®ï¼ˆ<code>append</code>,<code>appendleft</code>ï¼‰ éƒ½ä¼šå¯¼è‡´ç›¸åæ–¹å‘çš„ä¸€ç«¯æ•°æ®è¢«popï¼Œè¿™ä¸€ç‰¹æ€§å¯ä»¥è¢«ç”¨åœ¨ç±»ä¼¼å®æ—¶äº¤æ˜“ç›‘æ§ï¼Œunix tailåŸå‹å®ç°ç­‰ç­‰</p><p>å†…ç½®æ–¹æ³•ï¼š<code>append()</code>å³ç«¯æ·»åŠ ï¼Œ<code>appendleft()</code>å·¦ç«¯æ·»åŠ ï¼Œ <code>clear()</code>æ¸…ç©ºé˜Ÿåˆ—ï¼Œ<code>copy()</code>æµ…æ‹·è´ï¼ˆnew in 3.5ï¼‰&mldr;</p><p><code>count(x)</code> :è®°å½•ç­‰äº x çš„å…ƒç´ ä¸ªæ•°ã€‚</p><p><code>extend(iter)</code> å‘é˜Ÿåˆ—å³ä¾§æ‰¹é‡æ’å…¥ã€‚å·¦ä¾§æ’å…¥åˆ™æœ‰<code>extendleft()</code></p><p><code>index(x)</code>è·å–å…ƒç´ åæ ‡ï¼Œè¿˜å¯ä»¥æ·»åŠ startï¼Œstopå‚æ•°é€‰å®šæŸ¥æ‰¾èŒƒå›´ã€‚</p><p><code>insert(i,x)</code>å°†å…ƒç´ xæ’å…¥åˆ°é˜Ÿåˆ—çš„iä½ç½®ã€‚</p><p><code>pop()</code>,<code>popleft()</code> åˆ†åˆ«ä»é˜Ÿåˆ—å³ä¾§ï¼Œ å·¦ä¾§å»é™¤å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ç©ºæŠ›å‡ºå¼‚å¸¸ã€‚</p><p><code>remove(x)</code>åˆ é™¤ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„å…ƒç´ x</p><p><code>reverse()</code>åè½¬</p><p><code>rotate()</code> è½®è½¬</p><p>ä¸€äº›å®˜æ–¹ä½¿ç”¨å®ä¾‹ï¼š</p><p>Linux tail çš„æœ€ç®€å®ç°ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>log_file</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path_to_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tail</span> <span class=o>=</span> <span class=n>deque</span><span class=p>(</span><span class=n>log_file</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>  <span class=c1># å¾—åˆ°äº†æ–‡ä»¶çš„æœ€ååè¡Œã€‚</span>
</span></span></code></pre></td></tr></table></div></div><p>æ±‚æ»‘åŠ¨å¹³å‡ï¼ç§»åŠ¨å¹³å‡ï¼ˆæ‹“å±•åˆ°æ±‚å·ç§¯ä»€ä¹ˆçš„ã€‚ã€‚ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>moving_average</span><span class=p>(</span><span class=n>iterable</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># moving_average([40, 30, 50, 46, 39, 44]) --&gt; 40.0 42.0 45.0 43.0</span>
</span></span><span class=line><span class=cl>    <span class=c1># http://en.wikipedia.org/wiki/Moving_average</span>
</span></span><span class=line><span class=cl>    <span class=n>it</span> <span class=o>=</span> <span class=nb>iter</span><span class=p>(</span><span class=n>iterable</span><span class=p>)</span> <span class=c1># è½¬æ¢ä¸ºè¿­ä»£ç±»å‹</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>deque</span><span class=p>(</span><span class=n>itertools</span><span class=o>.</span><span class=n>islice</span><span class=p>(</span><span class=n>it</span><span class=p>,</span> <span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>  <span class=c1># åˆå§‹åŒ– deque([40, 30])</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span><span class=o>.</span><span class=n>appendleft</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=c1># å¡«å……ç©ºæ•°æ®ã€‚ deque([0, 40, 30])</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>it</span><span class=p>:</span> <span class=c1># it = iter([50, 46, 39, 44])</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>+=</span> <span class=n>elem</span> <span class=o>-</span> <span class=n>d</span><span class=o>.</span><span class=n>popleft</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>d</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>elem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=n>s</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=4-defaultdict-å­—å…¸å·¥å‚>4. defaultdict ï¼ˆå­—å…¸å·¥å‚ï¼‰</h3><p>ä¸€ä¸ªå†…å»ºæ•°æ®ç±»å‹ dict çš„å­ç±»ï¼Œ åœ¨dictçš„åŸºç¡€ä¸Šé‡æ„äº†ä¸€ä¸ªå†…å»ºæ–¹æ³•ï¼Œ å¹¶æ·»åŠ äº†ä¸€ä¸ªå¯ç¼–è¾‘çš„å®ä¾‹å˜é‡ã€‚</p><p>some cookies</p><p>åˆ©ç”¨ defaultdict of list å°†ä¸€ä¸ªkey-value åºåˆ—åˆ†ç»„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>sol</span> <span class=o>=</span> <span class=p>[(</span><span class=s1>&#39;ç”·&#39;</span><span class=p>,</span> <span class=s1>&#39;vici&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;å¥³&#39;</span><span class=p>,</span> <span class=s1>&#39;Rancho&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;ä¸­æ€§&#39;</span><span class=p>,</span> <span class=s1>&#39;Littlekey&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;ç”·&#39;</span><span class=p>,</span> <span class=s1>&#39;Guido&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;å¥³&#39;</span><span class=p>,</span> <span class=s1>&#39;æŸå¾æŸxuan&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>sol</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>d</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>items</span><span class=p>())</span> <span class=o>==</span> <span class=p>[(</span><span class=s1>&#39;ä¸­æ€§&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;Littlekey&#39;</span><span class=p>]),</span> <span class=p>(</span><span class=s1>&#39;å¥³&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;Rancho&#39;</span><span class=p>,</span> <span class=s1>&#39;æŸå¾æŸxuan&#39;</span><span class=p>]),</span> <span class=p>(</span><span class=s1>&#39;ç”·&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;vici&#39;</span><span class=p>,</span> <span class=s1>&#39;Guido&#39;</span><span class=p>])]</span>
</span></span></code></pre></td></tr></table></div></div><p>å½“dictä¸­çš„æŸä¸ªé”®ä¸å­˜åœ¨ä¸”è¢«è°ƒç”¨æ—¶ï¼Œdefaultdictä¼šä½¿ç”¨é»˜è®¤å·¥å‚è¿›è¡Œåˆå§‹åŒ–ï¼Œ æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­åœ¨è¿›è¡Œéå†solä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œ d[k] æ“ä½œä¼šç”Ÿæˆä¸€ä¸ªç©ºlistä¸ç›¸åº”çš„kå½¢æˆæ˜ å°„ã€‚</p><p>æ‰¿æ¥ä¸€ä¸‹Counterçš„éƒ¨åˆ†ï¼Œæœ¬å®å®ä¹‹å‰åšæ–‡ä»¶å­—æ•°ç»Ÿè®¡ç”¨çš„å°±æ˜¯defaultdictã€‚ã€‚ã€‚</p><h3 id=5-namedtupleå‘½åå…ƒç»„å·¥å‚>5. namedtupleï¼ˆå‘½åå…ƒç»„å·¥å‚ï¼‰</h3><p>å¿«é€Ÿå®ç°ç®€å•ç»“æ„ä½“çš„ä¸äºŒä¹‹é€‰ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>People</span> <span class=o>=</span> <span class=n>namedtuple</span><span class=p>(</span><span class=s1>&#39;People&#39;</span><span class=p>,</span> <span class=s1>&#39;name age birth school&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>People</span><span class=p>(</span><span class=s1>&#39;vici&#39;</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=s1>&#39;0701&#39;</span><span class=p>,</span> <span class=s1>&#39;WHUT&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>p</span> <span class=o>==</span> <span class=n>People</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;vici&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=mi>17</span><span class=p>,</span> <span class=n>birth</span><span class=o>=</span><span class=s1>&#39;0701&#39;</span><span class=p>,</span> <span class=n>school</span><span class=o>=</span><span class=s1>&#39;WHUT&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>p</span><span class=o>.</span><span class=n>school</span> <span class=o>==</span> <span class=s1>&#39;WHUT&#39;</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>p</span><span class=o>.</span><span class=n>age</span> <span class=o>==</span> <span class=mi>17</span>
</span></span><span class=line><span class=cl><span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>,</span> <span class=o>*</span><span class=n>_</span> <span class=o>=</span> <span class=n>p</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>name</span>
</span></span></code></pre></td></tr></table></div></div><p>å½“ç„¶æ˜¯ç”¨å¸¦ç©ºæ ¼çš„å­—ç¬¦ä¸²æ¥åŒºåˆ†named_field åªæ˜¯ä¸ºäº†å±•ç¤º pythonçš„å¼ºå¤§è¯­æ³•ç³–ï¼Œæ–‡æ¡£æ¨èä½¿ç”¨<code>[name, age, birth, school]</code>çš„ä¼ å‚æ–¹å¼åˆ›å»ºå·¥å‚ã€‚</p><p>nametupleå¾ˆé€‚åˆåšä¸€äº›ç»“æ„åŒ–æ•°æ®ï¼Œç±»ä¼¼sqlæŸ¥è¯¢ï¼Œcsvï¼Œsqlite3ç­‰ç­‰ã€‚</p><p>ç›´æ¥æŠ„è¢­æ–‡æ¡£å®ä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>EmployeeRecord</span> <span class=o>=</span> <span class=n>namedtuple</span><span class=p>(</span><span class=s1>&#39;EmployeeRecord&#39;</span><span class=p>,</span> <span class=s1>&#39;name, age, title, department, paygrade&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>csv</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>emp</span> <span class=ow>in</span> <span class=nb>map</span><span class=p>(</span><span class=n>EmployeeRecord</span><span class=o>.</span><span class=n>_make</span><span class=p>,</span> <span class=n>csv</span><span class=o>.</span><span class=n>reader</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s2>&#34;employees.csv&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>))):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>emp</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>emp</span><span class=o>.</span><span class=n>title</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sqlite3</span>
</span></span><span class=line><span class=cl><span class=n>conn</span> <span class=o>=</span> <span class=n>sqlite3</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s1>&#39;/companydata&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cursor</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s1>&#39;SELECT name, age, title, department, paygrade FROM employees&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>emp</span> <span class=ow>in</span> <span class=nb>map</span><span class=p>(</span><span class=n>EmployeeRecord</span><span class=o>.</span><span class=n>_make</span><span class=p>,</span> <span class=n>cursor</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>emp</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>emp</span><span class=o>.</span><span class=n>title</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªclassmethod <code>_make(iterable)</code>ï¼šä»ä¸€ä¸ª iterableå¯¹è±¡æ–°å»ºå®ä¾‹ï¼Œ</p><p>å…¶ä»–å®ä¾‹æ–¹æ³•ï¼›</p><p><code>_asdist()</code> è¿”å›ä¸€ä¸ª orderedDictï¼Œå­˜æ”¾å­—æ®µååŠå…¶å¯¹åº”value.</p><p><code>_replace()</code>ä¿®æ”¹tumpleå€¼ã€‚</p><p><code>_source</code>è¯¥å±æ€§è¿”å›å¯äº¤ç”±<code>exec()</code>æ‰§è¡Œçš„åŸºäºå½“å‰pythonç‰ˆæœ¬çš„pythonæºç ã€‚</p><p><code>_fields</code>è¿”å›åŒ…å«æ‰€æœ‰å­—æ®µåçš„tuple.å¯ç”¨ä¸å¤šä¸ªnamedtupleçš„å¿«é€Ÿåˆå¹¶ã€‚</p><p>ç±»ä¼¼ä»€ä¹ˆä½œä¸ºç»§æ‰¿ç±»å’Œæ·»åŠ <code>__doc__ </code>çš„å’¸é±¼æ“ä½œæ‡’å¾—å†™äº†ã€‚</p><h3 id=6-ordereddictæœ‰åºå­—å…¸>6. OrderedDictï¼ˆæœ‰åºå­—å…¸ï¼‰</h3><p>å°±æ˜¯æœ‰åºå­—å…¸å˜›ï¼Œæœ‰ä»€ä¹ˆå¥½è¯´çš„å‡¸^-^å‡¸ã€‚éš¾é“è¿™ç©æ„æ€ä¹ˆç”¨ä½ å¿ƒé‡Œè¿˜æ²¡ç‚¹bæ•°å˜›ï¼Ÿ</p><p>é™¤äº†æ‰€æœ‰çš„dictçš„æ–¹æ³•ï¼Œpython3.1åè¿˜æ·»åŠ äº†ä¸¤ä¸ªé¸¡è‚‹æ–¹æ³•<code>popitem()</code> & <code>move_to_end(key)</code>, å‰è€…ä¼šè¿”å›å¹¶åˆ é™¤å¯¹è±¡çš„æœ€åä¸€ä¸ªé”®å€¼å¯¹ï¼Œåè€…ä¼šæŠŠkeyæŒªåˆ°å­—å…¸æœ€åã€‚</p><h3 id=7-userdict-userlist-userstring-é›†åˆç±»å‹åŒ…è£…å¯¹è±¡>7. UserDict, UserList, UserString é›†åˆç±»å‹åŒ…è£…å¯¹è±¡</h3><p>python3ä¹‹å‰è¿™äº›ç±»å‹ä½œä¸ºå•ç‹¬moduleç‹¬ç«‹å­˜åœ¨ï¼Œåœ¨python3åè¢«æ•´åˆè¿›collections moduleï¼Œå…¶ä»–çš„ä¸€äº›æŠ½è±¡Mixin classç±»ä¼¼ <code>MutableMapping</code> åˆ™è¢«è¿ç§»åˆ°äº†<code>collections.abc</code>module.</p><p>å¦‚æœæƒ³è¦åˆ›å»ºä¸€ä¸ªdictçš„å­ç±»ï¼Œç›´æ¥ç»§æ‰¿dictè€Œä¸è¦ç»§æ‰¿UserDictï¼Œä½ å¥½æˆ‘å¥½å¤§å®¶å¥½ã€‚</p><p>æˆ‘è§‰å¾—<a class=link href=http://www.dongwm.com/archives/UserDict%E3%80%81UserString%E3%80%81UserList%E5%AD%98%E5%9C%A8%E7%9A%84%E6%84%8F%E4%B9%89/ target=_blank rel=noopener>dongweimingåšå®¢é‡Œçš„äº‹ä»¶</a>å®åœ¨æ˜¯æç«¯ã€‚è§ä»è§æ™ºï¼Œä¸–ç•Œå’Œå¹³ï½</p><h5 id=ä¸ç®—é¢˜å¤–çš„é¢˜å¤–è¯>ä¸ç®—é¢˜å¤–çš„é¢˜å¤–è¯ï¼š</h5><p>æˆ‘å¿äº†å¾ˆä¹…äº†ï¼ˆäº2017-08-09 00:27ï¼‰</p><p>å…¥èŒæ–°å…¬å¸åæˆ‘åˆä¸€æ¬¡é™·å…¥äº†é„™è§†é“¾ï¼šemacs > vim > ide</p><p>å¦‚æœæœ‰è°è¿˜æ•¢ç”¨è¿™ç§é„™è§†é“¾ææˆ‘ï¼Œæˆ‘åªæƒ³æŠ½å‡ºæˆ‘40ç±³çš„é•¿åˆ€ï¼Œè®©ä½ ä¸«å…ˆè·‘39ç±³å†ç®—è´¦ã€‚</p><p>ç¬¬ä¸€æ¬¡ç”¨viç±»çš„ç¼–è¾‘å™¨æ˜¯é«˜ä¸­æ—¶å€™æ— èŠç»™å®¶é‡Œç”µè„‘è£…äº†ä¸ªubuntu, ä¸‡èƒ½çš„ç½‘å‹è¯´nanoä¸å¦‚vimå¥½ç”¨ï¼Œä»æ­¤å…¥äº†vimçš„å‘ï¼ˆä¸è¿‡æˆ‘æ‰¿è®¤è¿™ä¹ˆå¤šå¹´è¿‡å»äº†æˆ‘vimä¹Ÿå°±æ˜¯å…¥é—¨æ°´å¹³ï¼‰ï¼Œå½“æ—¶ä¹…è§‰å¾—è¿™ç©æ„çœŸç‰¹ä¹ˆéš¾ç”¨è€è¦åˆ‡æ¢è¯»å†™ã€‚è¿ä¸ªå…³é—­æŒ‰é’®éƒ½æ²¡æœ‰ï¼Œbulabula&mldr;</p><p>ä½†æ˜¯åæ¥ä¹ æƒ¯åï¼Œæˆ‘è§‰å¾—ç”¨vimå†™cè¦æ¯”windowsä¸Šçš„vc6.0å¥½ç”¨å¤šäº†ã€‚å¤§å­¦æ¥è§¦äº†visual studio 2013ï¼15ï¼ˆå†™c#)ï¼ŒJetBrains IDEA (å†™java å’Œandroid)ï¼Œå°±å‡ ä¹æ”¾å¼ƒä½¿ç”¨ç¼–è¾‘å™¨äº†ã€‚</p><p>æˆ‘ç°åœ¨å†™pythonã€‚</p><p>æˆ‘å°±ä¸ä¿¡ä½ ä»¬ç”¨vimçš„èƒ½ä¸€ä¸ªcommand+bè·³è½¬åˆ° redis.lock.Lock æ–¹æ³•çš„æºç ï¼Œ æˆ‘å°±ä¸ä¿¡ä½ èƒ½åˆ é™¤ä¸Šä¸€è¡Œçš„æ—¶å€™ä¸‹ä¸€è¡Œçš„ç¼©è¿›è¿˜èƒ½è·Ÿç€è‡ªåŠ¨ä¿®æ”¹ã€‚æˆ‘ä¸ä¿¡ä½ nå¤šä¸ªé¡¹ç›®éƒ½å¸¦virtualenvçš„æ—¶å€™è¿˜èƒ½ç»™ä½ ä¸€ä¸ªç›¸åº”ç‰ˆæœ¬çš„python consoleï¼ipython tableã€‚</p><p>æˆ‘å°±æ˜¯å–œæ¬¢ideå ç”¨æˆ‘cpu30%æ—¶å€™çš„æ ·å­ã€‚ç”µè„‘å¡åªèƒ½æ€ªä½ çš„ç”µè„‘å·®ã€‚</p><p>ç”¨vim666çš„å¤§ä½¬æœ¬å®å®å¿ƒé‡Œä½©æœçš„ï¼Œä½†æ˜¯æˆ‘å†™ä»£ç æ˜¯ä¸ºäº†è‡ªå·±çˆ½ï¼Œwho care why are you so diaoï¼Ÿpycharm proè®©æˆ‘æœ‰é£ä¸€æ ·çš„æ„Ÿè§‰ï¼ŒçŠ¹å¦‚æ¿€å…‰æªï¼Œvimæœ€å¤šç®—æ˜¯å‹¾è·µå‰‘ï¼Œåªå¯ç ç“œåˆ‡èœï¼Œè€Œæˆ‘å¯ä»¥æŠŠä½ è½°æ€è‡³æ¸£ã€‚</p><p>å½“ç„¶æˆ‘ä¹Ÿåœ¨pycharmé‡ŒåŠ äº†vimæ’ä»¶ï¼Œæœ‰æœ¬äº‹ä½ æ‰“æˆ‘å•Šã€‚</p><p>è¿™å¯èƒ½æ˜¯ä¸€ä¸ªäº’ç›¸éª‚å‚»bï¼Œç„¶åæ…¢æ…¢æŠŠè‡ªå·±å˜æˆå‚»bçš„æ•…äº‹ã€‚</p></section><footer class=article-footer><section class=article-tags><a href=/tags/python/>python</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/pyenv-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/><div class=article-details><h2 class=article-title>pyenv å¸¸ç”¨å‘½ä»¤</h2></div></a></article><article><a href=/p/celery%E4%BB%BB%E5%8A%A1%E5%88%86%E5%8F%91-%E6%9C%AF%E4%B8%9A%E6%9C%89%E4%B8%93%E6%94%BB%E7%9A%84worker%E4%BB%AC/><div class=article-details><h2 class=article-title>celeryä»»åŠ¡åˆ†å‘-æœ¯ä¸šæœ‰ä¸“æ”»çš„workerä»¬</h2></div></a></article><article><a href=/p/%E4%BB%8Ekubelet-cgroup-%E7%AE%A1%E7%90%86%E6%B5%81%E7%A8%8B%E5%85%A5%E6%89%8B/><div class=article-details><h2 class=article-title>ä»kubelet Cgroup ç®¡ç†æµç¨‹å…¥æ‰‹</h2></div></a></article><article><a href=/p/vertical-scaling-of-pods-pod%E7%83%AD%E7%BC%A9%E6%94%BE/><div class=article-details><h2 class=article-title>Vertical Scaling of Pods | podçƒ­ç¼©æ”¾</h2></div></a></article><article><a href=/p/python%E9%87%8D%E4%BF%AE%E4%B9%8B%E6%97%85%E4%BA%94/><div class=article-details><h2 class=article-title>pythoné‡ä¿®ä¹‹æ—…ï¼ˆäº”ï¼‰</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//vic1blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2016 -
2024 ä½•è‚²åç‰ˆæƒæ‰€æœ‰</section><section class=powerby><a href=http://beian.miit.gov.cn>ç²¤ICPå¤‡19031392å·</a><br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>